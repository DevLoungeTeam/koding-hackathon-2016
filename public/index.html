<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#2A999A">
    <title>Math Game</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js" crossorigin="anonymous">
    <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/icons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/icons/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/icons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/icons/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/icons/manifest.json">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="apple-mobile-web-app-title" content="Math it">
    <meta name="application-name" content="Math it">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/icons/mstile-144x144.png">
    <meta property="og:url" content="http://169.44.71.171/" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Math it" />
    <meta property="og:description" content="&ldquo;Math it&rdquo; is a math game that rewards speed and skills." />
    <meta property="og:image" content="http://169.44.71.171/icons/promo1.png" />
    
    <style type="text/css">
        .night {
            background-image: url('/assets/night.png');
            transition: 0.5s;
            background-size: cover;
            background-position: fixed;
        }
        
        .day {
            background-image: url('/assets/day.png');
            background-size: cover;
            background-position: fixed;
        }
        
        .login {
            background: transparent;
            border: 0;
            background-image: url('/assets/login.png');
            background-size: cover;
        }
        
        .login:hover {
            background: transparent;
            border: 0;
            background-image: url('/assets/login_hover.png');
            background-size: cover;
        }
        
        .login:active {
            background: transparent;
            border: 0;
            background-image: url('/assets/login_click.png');
            background-size: cover;
        }
        
        .button {
            background: transparent;
            border: 0;
            background-image: url('/assets/button.png');
            background-size: cover;
        }
        
        .button:hover {
            background: transparent;
            border: 0;
            background-image: url('/assets/button_hover.png');
            background-size: cover;
        }
        
        .button:active {
            background: transparent;
            border: 0;
            background-image: url('/assets/button_click.png');
            background-size: cover;
        }
    
        body {
          padding-top: 40px;
          padding-bottom: 40px;
          background-color: #eee;
          color: white;
        }
        
        form {
            background-color: rgba(68, 93, 203, 0.5);
            border-radius: 10px 10px 10px 10px;
            -moz-border-radius: 10px 10px 10px 10px;
            -webkit-border-radius: 10px 10px 10px 10px;
            border: 0px solid #000000;
            padding: 10px;
        }
        
        .form-signin {
          max-width: 330px;
          padding: 15px;
          margin: 0 auto;
          background-color: rgba(98, 93, 173, 0.4);
        }
        .form-signin .form-signin-heading,
        .form-signin .checkbox {
          margin-bottom: 10px;
        }
        .form-signin .checkbox {
          font-weight: normal;
        }
        .form-signin .form-control {
          position: relative;
          height: auto;
          -webkit-box-sizing: border-box;
             -moz-box-sizing: border-box;
                  box-sizing: border-box;
          padding: 10px;
          font-size: 16px;
        }
        .form-signin .form-control:focus {
          z-index: 2;
        }
        .form-signin input[type="text"] {
          margin-bottom: -1px;
          border-bottom-right-radius: 0;
          border-bottom-left-radius: 0;
        }
        .form-signin input[type="password"] {
          margin-bottom: 10px;
          border-top-left-radius: 0;
          border-top-right-radius: 0;
        }
        
        /*********************************************/
        
        .form-signup {
          max-width: 330px;
          padding: 15px;
          margin: 0 auto;
        }
        
        .form-signup .form-signup-heading,
        .form-signup .checkbox {
          margin-bottom: 10px;
        }
        
        .form-signup .checkbox {
          font-weight: normal;
        }
        
        .form-signup .form-control {
          position: relative;
          height: auto;
          -webkit-box-sizing: border-box;
             -moz-box-sizing: border-box;
                  box-sizing: border-box;
          padding: 10px;
          font-size: 16px;
        }
        
        .form-signup .form-control:focus {
          z-index: 2;
        }
        
        .form-signup #inputUsername {
          margin-bottom: -1px;
          border-bottom-right-radius: 0;
          border-bottom-left-radius: 0;
        }
        
        .form-signup #inputEmail {
          margin-bottom: -1px;
          border-radius: 0;
        }
        
        .form-signup #inputPassword {
          margin-bottom: -1px;
          border-radius: 0;
        }
        
        .form-signup #inputCPassword {
          margin-bottom: 10px;
          border-top-left-radius: 0;
          border-top-right-radius: 0;
        }
        
        /**** FORM MENU ****/
        .form-menu {
          max-width: 330px;
          padding: 15px;
          margin: 0 auto;
        }
        .form-menu .form-menu-heading,
        .form-menu .checkbox {
          margin-bottom: 10px;
        }
        .form-menu .checkbox {
          font-weight: normal;
        }
        .form-menu .form-control {
          position: relative;
          height: auto;
          -webkit-box-sizing: border-box;
             -moz-box-sizing: border-box;
                  box-sizing: border-box;
          padding: 10px;
          font-size: 16px;
        }
        .form-menu .form-control:focus {
          z-index: 2;
        }
        .form-menu input[type="text"] {
          margin-bottom: -1px;
          border-bottom-right-radius: 0;
          border-bottom-left-radius: 0;
        }
        .form-menu input[type="password"] {
          margin-bottom: 10px;
          border-top-left-radius: 0;
          border-top-right-radius: 0;
        }
        
        /**** FORM MODE ****/
        .form-mode {
          max-width: 330px;
          padding: 15px;
          margin: 0 auto;
        }
        .form-mode .form-mode-heading,
        .form-mode .checkbox {
          margin-bottom: 10px;
        }
        .form-mode .checkbox {
          font-weight: normal;
        }
        .form-mode .form-control {
          position: relative;
          height: auto;
          -webkit-box-sizing: border-box;
             -moz-box-sizing: border-box;
                  box-sizing: border-box;
          padding: 10px;
          font-size: 16px;
        }
        .form-mode .form-control:focus {
          z-index: 2;
        }
        .form-mode input[type="text"] {
          margin-bottom: -1px;
          border-bottom-right-radius: 0;
          border-bottom-left-radius: 0;
        }
        .form-mode input[type="password"] {
          margin-bottom: 10px;
          border-top-left-radius: 0;
          border-top-right-radius: 0;
        }
        
        /**** FORM END ****/
        .form-end {
          max-width: 330px;
          padding: 15px;
          margin: 0 auto;
        }
        .form-end .form-end-heading,
        .form-end .checkbox {
          margin-bottom: 10px;
        }
        .form-end .checkbox {
          font-weight: normal;
        }
        .form-end .form-control {
          position: relative;
          height: auto;
          -webkit-box-sizing: border-box;
             -moz-box-sizing: border-box;
                  box-sizing: border-box;
          padding: 10px;
          font-size: 16px;
        }
        .form-end .form-control:focus {
          z-index: 2;
        }
        .form-end input[type="text"] {
          margin-bottom: -1px;
          border-bottom-right-radius: 0;
          border-bottom-left-radius: 0;
        }
        .form-end input[type="password"] {
          margin-bottom: 10px;
          border-top-left-radius: 0;
          border-top-right-radius: 0;
        }
        
    </style>
</head>
<body class="night">
    <div id="preloader"></div>
    <div class="container" style="height: 100%;">
    	
    </div>
    <!-- /container -->
    
    <!-- Audio zone -->
    <audio id="menuPlayer" loop>
        <source src="/assets/menu.mp3" type="audio/mpeg">
    </audio>
    <audio id="playPlayer" loop>
        <source src="/assets/play.mp3" type="audio/mpeg">
    </audio>
    <audio id="correctPlayer">
        <source src="/correct.mp3" type="audio/mpeg">
        <source src="/correct.ogg" type="audio/ogg">
    </audio>
    <!-- /Audio zone -->
    <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
    <script type="text/javascript" src="/js/jplayer/jquery.jplayer.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    <script type="text/javascript">
        var io = io("http://169.44.71.171");
        var _securityToken = "";
        var questionID = "";
        var timer = 0;
        var playing = 0;
        var showingOver = false;
        var musicPlaying = true;
    
        $(document).ready(function() {
            $.get('/templates/login.html', function(data) {
                $(".container").html(data);
                window.document.title = "Math Game :: Login";
                $('#preloader').fadeOut('slow');
            }); 
        });
        
        window.onload = function() {
        	setTimeout(function() {
        		new Image().src = "/assets/night.png";
        		new Image().src = "/assets/day.png";
        		new Image().src = "/assets/login.png";
        		new Image().src = "/assets/login_hover.png";
        		new Image().src = "/assets/login_click.png";
        		new Image().src = "/assets/button.png";
        		new Image().src = "/assets/button_hover.png";
        		new Image().src = "/assets/button_click.png";
        	}, 1000);
        };
    
        io.on("operation result", function(data) {
            if(data.status == true) {
                console.log(data);
                $("#inputResult").val("");
                if(musicPlaying) {
            	    var audio = document.getElementById("correctPlayer");
            	    audio.pause();
            	    audio.play();
                }
            	$("#modePoints").html(data.points);
            }
        });
        
        io.on("operation", function(data) {
            console.log("Dati ricevuti: " + data);
            timer = 3;
            questionID = data.questionID;
            playing = 1;
            $("#modeQuestionContent").html(data.operand1 + " " + data.operation + " " + data.operand2);
            $("#modeTimer").html(timer);
        });
        
        io.on("server tick", function(data) {
            if(timer != 0 && questionID != "") {
                if(playing) timer--;
                $("#modeTimer").html(timer);
                
                if(playing) io.emit("check timer", { _securityToken: _securityToken, questionID: questionID });
            }
            
            if(timer == 0 && questionID != "") {
                $("#inputResult").val("Checking...");
                questionID = "";
            }
        });
        
        io.on("show lose page", function(data) {
            if(showingOver)
                return;
            
            if(musicPlaying) {
                var audio = document.getElementById("menuPlayer");
                audio.pause();
                
                var audio = document.getElementById("playPlayer");
                audio.pause();
                audio.play(); 
            }
            
            console.log(data);
            $("#inputResult").attr("disabled");
            $.get('/templates/end.html', function(page) {
                $(".container").html(page);
                $("#points").html(data.points);
                window.document.title = "Math Game :: Game over";
                showingOver = true;
            });
        });
        
        io.on("position", function(data) {
            $("#yourPosition").html(data);
        });
        
        io.on("first 10", function(data) {
            $("#data").append("<tr>\
                <td>" + data.id + "</td>\
                <td>" + data.username + "</td>\
                <td>" + data.record + "</td>\
            </tr>");
        });
    </script>
</body>
</html>